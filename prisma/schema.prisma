generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Student {
  id              String    @id @default(uuid())
  full_name       String
  faculty         String
  group           String
  email           String?   @unique
  phone           String?
  birth_date      DateTime
  enrollment_year Int
  status          Status    @default(active)
  profile_picture String?   // Profile picture URL/path
  deleted_at      DateTime? // Soft delete
  created_at      DateTime  @default(now())
  updated_at      DateTime  @updatedAt
  created_by      String?   // Audit: who created
  updated_by      String?   // Audit: who updated
  auditLogs       AuditLog[]
}

model AuditLog {
  id          String   @id @default(uuid())
  entity_type String   // e.g., "Student"
  entity_id   String   // ID of the entity
  action      String   // "CREATE", "UPDATE", "DELETE"
  user_id     String?  // Who performed the action
  changes     Json?    // What changed (JSON object)
  ip_address  String?
  user_agent  String?
  created_at  DateTime @default(now())
  
  student     Student? @relation(fields: [entity_id], references: [id], onDelete: Cascade)
}

enum Status {
  active
  graduated
  expelled
  academic_leave
}
